opt_prompt_file = "my_prompt.Rmd"

project_dir = "/home/rstudio/repbox/projects_gha_new/aejapp_10_4_6"
schema_dir = "/home/rstudio/repbox/gemini/repboxAI/inst/prod_schemas"
repboxDB_dir = "~/repbox/repboxDB"

include_files = '''

'''
exclude_files = '''
*.toml
'''

template = '''

Below are relevant files from my R project.

# R project DESCRIPTION file (repboxRegmap)

{{DESCRIPTION}}

# R project README file (repboxRegmap)

{{README}}


# R code files: (repboxRegmap)

{{R}}


# Example description of table cells

The following data set was generated for one particular article,
using AI and heuristics. The structure of the data set will be
the same for other articles. Further below, are other example data
sets for the same article.

{{cell_base}}

# AI response schemas for regression mappings

{{schemas}}

# Example mappings generated by AI corresponding to schema above

Again the files are generated for the same example article.
For each AI response schema, we can have multiple versions of the AI
mappings, e.g. using different models or temperatures, or just multiple
runs with the same parameters.

{{fp_maps}}

# Example regression ouputs

Below are data sets from the example article containing general run info and
extracted information from the regressions when we reproduced the reproduction package.
This output can be easier mapped to the table cells than the raw Stata output.

{{repdb}}

To load these parcels use the repbd_load_parcels function from
the package repboxDB:

```r
repdb_load_parcels = function(project_dir, parcel_names, parcels=NULL) {
  restore.point("repdb_load_parcels")
  parcel_names = setdiff(parcel_names, names(parcels))
  if (length(parcel_names)==0) return(parcels)

  parcel_df = repdb_list_parcels(project_dir)
  rows = match(parcel_names, parcel_df$parcel)
  use = !is.na(rows)
  paths = parcel_df$path[rows[use]]
  new_parcels = lapply(paths, readRDS)
  names(new_parcels) = parcel_names[use]
  if (length(parcels)==0) return(new_parcels)
  c(parcels, new_parcels)
}
```

# Example rme file

Example of saved rme.Rds file for an article.
Generated with rme_init and possibly containing some evaluations.
Might be outdated and not exactly correspond to the newest package version.

{{rme}}


{{mod_instruct}}

##################################
# Coding Style
##################################

When you write R code:

- Prefer stringi functions for string operations (exception paste0 is fine)
- Prefer = as assignment operator over <-
- DO NOT use `.data$col` syntax within dplyr verbs e.g. do not write `filter(.data$x>0)` just write `filter(x>0)` instead.

##################################
# Your Task
##################################



'''



file_template = '''

# FILE: {{filename}}
```
{{filetext}}
```
# END OF FILE: {{filename}}

-----------------------------------------------------------
'''

[[repdb]]

include_files = '''
{{project_dir}}/repdb/stata_reg_cmd.Rds
{{project_dir}}/repdb/stata_reg_run_info.Rds
{{project_dir}}/repdb/stata_run_logs.Rds
{{project_dir}}/repdb/reg_core.Rds
{{project_dir}}/repdb/regcoef.Rds
{{project_dir}}/repdb/regscalar.Rds
{{project_dir}}/repdb/regstring.Rds
{{project_dir}}/repdb/regvar.Rds
{{project_dir}}/repdb/regxvar.Rds
'''

[[schemas]]

include_files = '''
{{schema_dir}}/map_reg_run.json
{{schema_dir}}/map_reg_static.json
{{schema_dir}}/map_inv_reg_run.json
{{schema_dir}}/tab_html.json
'''

[[cell_base]]

include_files = '''
{{project_dir}}/fp/prod_art/cell_base/mocr/v0/prod_df.Rds
'''

[[fp_maps]]

include_files = '''
{{project_dir}}/fp/prod_art/map_reg_run/**/prod_df.Rds
{{project_dir}}/fp/prod_art/map_inv_reg_run/**/prod_df.Rds
{{project_dir}}/fp/prod_art/map_reg_static/**/prod_df.Rds
'''


[[rme]]

include_files = '''
{{project_dir}}/fp/eval_art/rme.Rds
'''


[[report_html]]

include_files = '''
{{report_dir}}/map_report.html
'''


################################################
# Special handling for R code
################################################
[[R]]
include_files  = '''
R/*.R
R/*.r
'''

[[plan]]
include_files = "plan.md"


[[README]]
include_files = "README.md"

[[DESCRIPTION]]
include_files = "DESCRIPTION"
file_template = '''
```
{{filetext}}
```
'''


